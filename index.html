<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Zeytinyağı Stok Takip</title>

  <!-- Supabase SDK -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- Stil -->
  <link rel="stylesheet" href="styles.css">

  <!-- Uygulama -->
  <script src="app.js" defer></script>
</head>

<body>

<aside class="sidebar">
  <div class="sb-header">
    <h2 class="sb-logo">Stok Panel</h2>
    <div class="sb-user">
      <span id="userEmail">…</span>
      <button id="btnLogout" class="logout-btn">Çıkış</button>
    </div>
  </div>

  <nav class="sb-nav">
    <button class="sb-link active" data-tab="giris">Mal Giriş</button>
    <button class="sb-link" data-tab="cikis">Mal Çıkış</button>
    <button class="sb-link" data-tab="tanklar">Tanklar</button>
    <button class="sb-link" data-tab="rapor">Raporlar</button>
    <button class="sb-link" data-tab="tedarikci">Tedarikçiler</button>
  </nav>
</aside>

<main class="container layout">

  <!-- =================== MAL GİRİŞ =================== -->
  <section class="tab" id="giris" style="display:block;">
    <h2>Mal Girişi</h2>

    <form id="entryForm" class="card">
      <div class="grid">
        <label>Tarih<input type="date" name="date" required></label>
        <label>Fiş No<input type="text" name="fis_no"></label>

        <label>Tedarikçi
          <select name="supplier_id" id="supplierSelect"></select>
        </label>

        <label>Tank
          <select name="tank_id" id="tankSelect1"></select>
        </label>

        <label>Kalite
          <select name="kalite" required>
            <option value="EXTRA V.">EXTRA V.</option>
            <option value="NATURAL 1.">NATURAL 1.</option>
            <option value="HAM">HAM</option>
          </select>
        </label>

        <label>Asit (%)<input type="number" step="0.0001" name="acid" required></label>
        <label>KG<input type="number" step="0.001" name="kg" required></label>

        <label>Birim Fiyat<input type="number" step="0.01" name="price"></label>
        <label>Komisyon<input type="number" step="0.01" name="komisyon"></label>

        <label class="full">Açıklama<input type="text" name="aciklama"></label>
      </div>

      <button class="primary" type="submit">Kaydet</button>
      <p id="entryMsg" class="muted"></p>
    </form>

    <div class="card">
      <table id="entryTable">
        <thead>
          <tr><th>Tarih</th><th>Fiş</th><th>Tedarikçi</th><th>Tank</th><th>Kalite</th><th>KG</th><th>Asit</th><th>Fiyat</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- =================== MAL ÇIKIŞ =================== -->
  <section class="tab" id="cikis">
    <h2>Mal Çıkış</h2>

    <form id="exitForm" class="card">
      <div class="grid">
        <label>Tarih<input type="date" name="date" required></label>

        <label>Tank
          <select name="tank_id" id="tankSelect2"></select>
        </label>

        <label>Kalite
          <select name="kalite" required>
            <option value="EXTRA V.">EXTRA V.</option>
            <option value="NATURAL 1.">NATURAL 1.</option>
            <option value="HAM">HAM</option>
          </select>
        </label>

        <label>KG<input type="number" step="0.001" name="kg" required></label>
        <label>Satış Fiyatı<input type="number" name="price" step="0.01"></label>
        <label>Fatura No<input type="text" name="invoice_no"></label>

        <label class="full">Açıklama<input type="text" name="description"></label>
      </div>
      <button class="primary" type="submit">Kaydet</button>
      <p id="exitMsg" class="muted"></p>
    </form>

    <div class="card">
      <table id="exitTable">
        <thead>
        <tr><th>Tarih</th><th>Tank</th><th>Kalite</th><th>KG</th><th>Fiyat</th><th>Fatura</th><th>Açıklama</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- =================== TANKLAR =================== -->
  <section class="tab" id="tanklar">
    <h2>Tanklar</h2>

    <form id="tankForm" class="card">
      <div class="grid">
        <label>Tank Adı<input type="text" name="tank_name" required></label>
        <label>Kapasite<input type="number" name="capacity_kg" required></label>
      </div>
      <button class="secondary" type="submit">Ekle</button>
      <p id="tankMsg" class="muted"></p>
    </form>

    <div class="card">
      <table id="tankTable">
        <thead>
        <tr><th>Tank</th><th>Kapasite</th><th>Mevcut</th><th>Doluluk</th><th>Asit Ort</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <h3>Tank Doluluk</h3>
      <div id="tankVisuals"></div>
    </div>
  </section>

  <!-- =================== RAPOR =================== -->
  <section class="tab" id="rapor">
    <h2>Raporlar</h2>

    <div class="card">
      <div class="grid">
        <label>Başlangıç<input type="date" id="repStart"></label>
        <label>Bitiş<input type="date" id="repEnd"></label>
        <button id="btnRunReport" class="secondary" type="button">Getir</button>
        <button id="btnExcel" class="secondary" type="button">Excel</button>
      </div>
    </div>

    <div class="card">
      <table id="reportTable">
        <thead>
          <tr>
            <th>Kalite</th>
            <th>Giriş KG</th>
            <th>Çıkış KG</th>
            <th>Ort. Alış</th>
            <th>Ort. Satış</th>
            <th>Kâr</th>
            <th>Net KG</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

  </section>

  <!-- =================== TEDARİKÇİ =================== -->
  <section class="tab" id="tedarikci">
    <h2>Tedarikçiler</h2>

    <form id="supplierForm" class="card">
      <div class="grid">
        <label>İsim<input type="text" name="name" required></label>
        <label>Adres<input type="text" name="address"></label>
        <label>Telefon<input type="text" name="phone"></label>
        <label class="full">Not<input type="text" name="note"></label>
      </div>
      <button class="secondary" type="submit">Ekle</button>
      <p id="supplierMsg" class="muted"></p>
    </form>

    <div class="card">
      <table id="supplierTable">
        <thead><tr><th>İsim</th><th>Adres</th><th>Tel</th><th>Not</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

</main>

</body>
</html>
